= Inugami Project analysis maven plugin
:toc:

== Last Release:
----
<dependency>
    <groupId>io.inugami.maven.plugin.analysis</groupId>
    <artifactId>inugami-project-analysis-maven-plugin</artifactId>
    <version>1.2.1</version>
</dependency>
----

== Quick start :

In your project pom.xml (or settings) we need to add some properties :

----
<properties>
    <inugami.maven.plugin.analysis.project.base.name>your.base.package</inugami.maven.plugin.analysis.project.base.name>
            <inugami.maven.plugin.analysis.writer.neo4j.url>bolt://localhost:7687</inugami.maven.plugin.analysis.writer.neo4j.url>
        <inugami.maven.plugin.analysis.writer.neo4j.user>neo4j</inugami.maven.plugin.analysis.writer.neo4j.user>
            <inugami.maven.plugin.analysis.writer.neo4j.password>password</inugami.maven.plugin.analysis.writer.neo4j.password>
</properties>
----

In your project build definition :
----
<plugin>
    <groupId>io.inugami.maven.plugin.analysis</groupId>
    <artifactId>inugami-project-analysis-maven-plugin</artifactId>
    <version>1.2.1</version>
    <extensions>true</extensions>
    <executions>
        <execution>
            <id>check</id>
            <phase>analyze</phase>
            <goals>
                <goal>check</goal>
            </goals>
        </execution>
        <execution>
            <id>info</id>
            <phase>info</phase>
            <goals>
                <goal>retrieveInformation</goal>
            </goals>
        </execution>
    </executions>
</plugin>
----

First you need to analyse your project to send into Neo4j data :

----
mvn analyze
----

After this analyse you can see in Neo4j your project informations or execute maven phase  info

----
mvn info
----



== Neo4j data structure :
image::doc/nodes.png[]

== Analyzers :

=== Feign clients
Feign clients analyzer scan all feign client interface to resolve project consuming REST endpoints;

.Properties
|===
|Property | type | default value | description

|inugami.maven.plugin.analysis.analyzer.feign.enable
|boolean
|true
|Allow to disable feign client analyzer
|===

=== SpringBoot RestControllers
To resolve project REST endpoint exposition, this analyzer scan all SpringBoot RestController.

.Properties
|===
|Property | type | default value | description

|inugami.maven.plugin.analysis.analyzer.restControllers.enable
|boolean
|true
|Allow to disable feign client analyzer
|===

=== Spring properties
Most part of issues on project come from wrong properties configuration.
This analyzer scan all properties injected by @Value annotation or Bean configuration definition.

.Properties
|===
|Property | type | default value | description

|inugami.maven.plugin.analysis.analyzer.properties.enable
|boolean
|true
|Allow to disable feign client analyzer
|===

=== ActiveMQ
For resolve activeMQ consumers and listeners, this analyzer is able to scan all Spring @JmsListener annotation.

.Properties
|===
|Property | type | default value | description

|inugami.maven.plugin.analysis.analyzer.jms.enable
|boolean
|true
|Allow to disable feign client analyzer
|===


=== Error code
For resolve activeMQ consumers and listeners, this analyzer is able to scan all Spring @JmsListener annotation.

.Properties
|===
|Property | type | default value | description

|inugami.maven.plugin.analysis.analyzer.errorCode.enable
|boolean
|true
|Allow to disable error codeanalyzer

|inugami.maven.plugin.analysis.analyzer.errorCode.interface
|String
|io.inugami.api.exceptions.ErrorCode
|Allow to specify the error code interface, configured by default with inugami error code interface

|inugami.maven.plugin.analysis.analyzer.errorCode.fieldName
|String
|errorCode
|Allow to override the default error code "field". This field is resolve with method define in error code interface. Accessor prefix is ignore
|===


==== Sender tracking
Spring doesn't include annotation for ActiveMQ senders. Sending message is execute by calling JmsTemplate.
To retrieve this information, Inugami project have specific annotation to flag your methods who send JMS events :

----
@JmsSender(destination = "${my.activeMq.onUserCreated.queue}", id = "create.user.queue")
public void sendCreateUser(final String someParameter, @JmsSenderBody final User user) {
    // implementation
}
----

The destination have the same sens than Spring @JmsListener destination.

This specific annotation is present in inugami-project-analysis-maven-plugin-annotations :
----
<dependency>
    <groupId>io.inugami.maven.plugin.analysis</groupId>
    <artifactId>inugami-project-analysis-maven-plugin-annotations</artifactId>
    <version>${project.version}</version>
</dependency>
----



== Extents with custom analyzers :
This plugin allow to append plugin by including basic JAR dependencies. All plugin features are
define by SPI interfaces.


=== ProjectScanner

----
include::inugami-project-analysis-maven-plugin-api-mvn/src/main/java/io/inugami/maven/plugin/analysis/api/actions/ProjectScanner.java[lines=17..30]
----


=== ClassAnalyzer

----
include::inugami-project-analysis-maven-plugin-api-mvn/src/main/java/io/inugami/maven/plugin/analysis/api/actions/ClassAnalyzer.java[lines=17..35]
----

=== ProjectPreAnalyzer

----
include::inugami-project-analysis-maven-plugin-api-mvn/src/main/java/io/inugami/maven/plugin/analysis/api/actions/ProjectPreAnalyzer.java[lines=17..32]
----

=== ProjectPostAnalyzer
----
include::inugami-project-analysis-maven-plugin-api-mvn/src/main/java/io/inugami/maven/plugin/analysis/api/actions/ProjectPostAnalyzer.java[lines=17..33]
----

=== ResultWriter
----
include::inugami-project-analysis-maven-plugin-api-mvn/src/main/java/io/inugami/maven/plugin/analysis/api/actions/ResultWriter.java[lines=17..34]
----

